import{t as A,r as d,S as M,x as _,j as e,y as j}from"./index-bf82c2d2.js";import{e as t}from"./exportFromJSON-59a1cb7c.js";import{W as Q,X as V,Y as X,Z as Y,a0 as z,a1 as K,K as R,i as W,n as E}from"./Layout-175bf00a.js";const H=({title:o,totalDoc:N,exportData:n,isDisabled:S,handleSelectFile:T,filename:g,handleRemoveSelectFile:F,handleUploadMultiple:O})=>{const a=A(),m=d.useRef(),[b,l]=d.useState(!1),{loading:P}=d.useContext(M),[x,c]=d.useState({name:"",status:!1}),I=()=>{a.pathname==="/products"&&(c({name:"csv",status:!0}),E.getAllProducts({page:1,limit:N,category:null,title:null,price:0}).then(r=>{var v,w,k,C;l(!1),c({name:"",status:!1}),console.log("res.products===>",r.products);const u=s=>{let i=[];return s.forEach(y=>{i.push(y._id)}),i.join(", ")},h=s=>{let i=[];return s.forEach(y=>{i.push(y.medialink)}),i.join(", ")};let f=[];for(let s of r.products){const i={title:s.title,description:s.description,prices:(v=s==null?void 0:s.prices)==null?void 0:v.price,sale_price:(w=s==null?void 0:s.prices)==null?void 0:w.salePrice,MOQ:s.minimumOrderOfQuantity,categories:u(s==null?void 0:s.categories),tax:s==null?void 0:s.tax.join(", "),tag:s==null?void 0:s.tag.join(", "),slug:s.slug,category:(k=s.category)==null?void 0:k._id,image:h(s==null?void 0:s.image),sku:s==null?void 0:s.sku,stock:s.stock,warranty:(C=s.warrantyPeriods)==null?void 0:C.duration,status:s.status};f.push(i)}console.log("newCsv",f),t({data:f,fileName:"products",exportType:t.types.csv})}).catch(r=>{c({name:"",status:!1}),l(!1)})),a.pathname==="/categories"&&t({data:n,fileName:"categories",exportType:t.types.csv}),a.pathname==="/attributes"&&t({data:n,fileName:"attributes",exportType:t.types.csv}),a.pathname==="/coupons"&&t({data:n,fileName:"coupons",exportType:t.types.csv}),a.pathname==="/customers"&&t({data:n,fileName:"customers",exportType:t.types.csv})},B=()=>{a.pathname==="/products"&&(c({name:"json",status:!0}),E.getAllProducts({page:1,limit:N,category:null,title:null,price:0}).then(r=>{l(!1),c({name:"json",status:!0}),t({data:r.products,fileName:"products",exportType:t.types.json})}).catch(r=>{l(!1),c({name:"json",status:!0})})),a.pathname==="/categories"&&t({data:n,fileName:"categories",exportType:t.types.json}),a.pathname==="/attributes"&&t({data:n,fileName:"attributes",exportType:t.types.json}),a.pathname==="/coupons"&&t({data:n,fileName:"coupons",exportType:t.types.json}),a.pathname==="/customers"&&t({data:n,fileName:"customers",exportType:t.types.json})};d.useEffect(()=>{const r=u=>{var h;(h=m==null?void 0:m.current)!=null&&h.contains(u.target)||l(!1)};document.addEventListener("mousedown",r)},[m]);const[L,J]=d.useState(!1),U=r=>{J(u=>!u)},{t:p}=_();return e.jsxs("div",{className:" lg:flex md:flex flex-grow-0",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("div",{ref:m,className:"lg:flex-1 md:flex-1 mr-3 sm:flex-none",children:[(o==="Products"||o==="Attribute"||o==="Extra"||o==="Coupon"||o==="Customers"||o==="Categories")&&e.jsxs("button",{onClick:()=>{l(!b)},className:"border flex justify-center items-center border-gray-300 hover:border-green-400 hover:text-green-400  dark:text-gray-300 cursor-pointer h-10 w-20 rounded-md focus:outline-none",children:[e.jsx(Q,{className:"mr-2"}),e.jsx("span",{className:"text-xs",children:p("Export")})]}),b&&e.jsxs("ul",{className:"origin-top-left absolute  w-56 rounded-md shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 focus:outline-none z-40",style:{},children:[e.jsx("li",{className:"justify-between font-serif font-medium py-2 pl-4 transition-colors duration-150 hover:bg-gray-100 text-gray-500 hover:text-green-500 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-200",children:e.jsx("button",{type:"button",onClick:I,className:"focus:outline-none",children:e.jsxs("span",{className:"flex items-center text-sm",children:[e.jsx(V,{className:"w-4 h-4 mr-3","aria-hidden":"true"}),e.jsxs("span",{children:["Export to CSV",x.name==="csv"&&x.status&&"...."]})]})})}),e.jsx("li",{className:"justify-between font-serif font-medium py-2 pl-4 transition-colors duration-150 hover:bg-gray-100 text-gray-500 hover:text-green-500 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-200",children:e.jsx("button",{type:"button",className:"focus:outline-none",onClick:B,children:e.jsxs("span",{className:"flex items-center text-sm",children:[e.jsx(X,{className:"w-4 h-4 mr-3","aria-hidden":"true"}),e.jsxs("span",{children:["Export to JSON",x.name==="json"&&x.status&&"...."]})]})})})]})]}),e.jsx("div",{className:"lg:flex-1 md:flex-1 mr-3  sm:flex-none",children:e.jsxs("button",{onClick:U,className:"border flex justify-center items-center h-10 w-20 hover:text-yellow-400  border-gray-300 dark:text-gray-300 cursor-pointer  py-2 hover:border-yellow-400 rounded-md focus:outline-none",children:[e.jsx(Y,{className:"mr-2"}),e.jsx("span",{className:"text-xs",children:"Import"})]})})]}),L&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full my-2 lg:my-0 md:my-0 flex",children:[e.jsx("div",{className:"h-10 border border-dashed border-green-500 rounded-md",children:e.jsxs("label",{className:"w-full rounded-lg h-10 flex justify-center items-center text-xs dark:text-gray-400 leading-none",children:[e.jsx(j.Input,{disabled:S,type:"file",accept:".csv,.xls,.json",onChange:T}),g||e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mx-2 text-green-500 text-lg dark:text-gray-400"})," ",p("SelectYourJSON")," ",o," ",p("File")]}),g&&e.jsx("span",{onClick:F,type:"button",className:"text-red-500 focus:outline-none mx-4 text-lg",children:e.jsx(K,{})})]})}),e.jsx("div",{className:"flex",children:P?e.jsxs(j.Button,{className:"ml-2 h-10",children:[e.jsx("img",{src:R,alt:"Loading",width:20,height:10})," ",e.jsx("span",{className:"font-serif ml-2 font-light",children:"Processing"})]}):e.jsxs(j.Button,{onClick:O,className:"w-full rounded-md h-10 ml-2  text-xs px-2",children:[e.jsx("span",{className:"",children:e.jsx(W,{})}),e.jsx("span",{className:" text-sx w-20",children:p("ImportNow")})]})})]})})]})};export{H as U};
